!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Weixin=t():e.Weixin=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";function r(e,t){var n=parseInt(u.localS.getItem(d)||0,10);return u.localS.setItem(d,++n),console.log("请求了微信sign接口："+n+" 次"),fetch(e,{body:Object.assign({appId:"xxxxxxx",secret:"yyyyyy",url:location.href.split("#")[0]},t)}).then(function(e){e&&e.data&&(u.localS.setItem(c,+new Date),u.localS.setItem(p,e.data),a.default.init(e.data))})}function o(e,t){var n=+new Date,o=parseInt(u.localS.getItem(c)||0,10),i=n-o>l,s=parseInt(u.localS.getItem(f)||0,10),a=n-s>h;i&&a&&(u.localS.setItem(f,n),r(e,t))}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a.default.G_SIGN_PACKAGE=a.default.G_SIGN_PACKAGE||u.localS.getItem(p);var n=0,o=t.success;delete t.success,delete t.fail;var i=function i(){return new Promise(function(s,u){a.default.invoke(e,Object.assign({success:function(e){o&&o.call(this,e),s(e)},fail:function(e){0===n?(n++,r().then(function(){return i()})):u(e)}},t))})};return a.default.G_SIGN_PACKAGE?i():r().then(function(){return i()})}Object.defineProperty(t,"__esModule",{value:!0}),t.wxInvoke=t.wxInject=t.isWeixin=void 0;var s=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(s);n(2);var u=n(3),c="ISWXSIGNATUREEXPIRE",l=65e5,f="WXSIGNPREVENTREPEAT",h=1e4,d="WXREQUESTSIGNCOUNT",p="WXGSIGNPACKAGE",y=function(){var e={isWeixin:!1,version:-1},t=/MicroMessenger\/([\d.]+)/i,n=navigator.userAgent.match(t);return n&&(e.isWeixin=!0,e.version=n[1]),e}().isWeixin;t.isWeixin=y,t.wxInject=o,t.wxInvoke=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={G_SIGN_PACKAGE:null,init:function(e,t,n){"function"==typeof e?(t=e,e=null):this.G_SIGN_PACKAGE=e;var r=["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","hideMenuItems","showMenuItems","chooseImage","previewImage","uploadImage","downloadImage","getNetworkType","openLocation","getLocation","hideOptionMenu","showOptionMenu","closeWindow","scanQRCode","getWXDeviceInfos","openWXDeviceLib","onScanWXDeviceResult","onReceiveDataFromWXDevice","onWXDeviceBluetoothStateChange","onWXDeviceBindStateChange","onWXDeviceStateChange","sendDataToWXDevice","startScanWXDevice","stopScanWXDevice","getWXDeviceTicket","connectWXDevice","disconnectWXDevice"];wx.config({debug:!1,appId:this.G_SIGN_PACKAGE.appId,timestamp:this.G_SIGN_PACKAGE.timestamp,nonceStr:this.G_SIGN_PACKAGE.nonceStr,signature:this.G_SIGN_PACKAGE.signature,jsApiList:r}),wx.error(function(e){n?n(e):alert("微信JSAPI验证失败："+e.errMsg)});var o=this;return wx.ready(function(){t&&t(o)}),this},checkJsApi:function(e,t){wx.checkJsApi({jsApiList:[e],success:function(n){if(n.errMsg="checkJsApi:ok"){!0===n.checkResult[e]?t.success&&t.success():alert("接口"+e+"不支持，请检查接口名称或升级微信到最新版本")}else alert(n.errMsg)},fail:t.fail})},invoke:function(e,t){this.checkJsApi(e,{success:function(){t=t||{},t.title=t.title||document.title,t.fail=t.fail||function(e){alert("调用微信接口失败："+JSON.stringify(e))},wx[e](t)},fail:t.fail})},share:function(e){this.G_SIGN_PACKAGE&&(this.invoke("showOptionMenu"),e.imgUrl=this._getShareImgUrl(e),this.invoke("onMenuShareTimeline",{title:e.title,link:e.link,imgUrl:e.imgUrl,success:function(){e.success&&e.success("onMenuShareTimeline")},cancel:function(){e.cancel&&e.cancel("onMenuShareTimeline")},fail:e.fail}),this.invoke("onMenuShareAppMessage",{title:e.title,desc:e.desc,link:e.link,imgUrl:e.imgUrl,type:"",dataUrl:"",success:function(){e.success&&e.success("onMenuShareAppMessage")},cancel:function(){e.cancel&&e.cancel("onMenuShareAppMessage")},fail:e.fail}),this.invoke("onMenuShareQQ",{title:e.title,desc:e.desc,link:e.link,imgUrl:e.imgUrl,success:function(){e.success&&e.success("onMenuShareQQ")},cancel:function(){e.cancel&&e.cancel("onMenuShareQQ")},fail:e.fail}),this.invoke("onMenuShareWeibo",{title:e.title,desc:e.desc,link:e.link,imgUrl:e.imgUrl,success:function(){e.success&&e.success("onMenuShareWeibo")},cancel:function(){e.cancel&&e.cancel("onMenuShareWeibo")},fail:e.fail}))},_getShareImgUrl:function(e){var t="";if(e.imgUrl)t=e.imgUrl;else if(!(t=document.getElementsByTagName("img")[0].src))return"";return null==t.match("http\\:")&&(t=null!=t.match("\\.\\.")?t.replace("..",location.origin+"/"):location.origin+"/"+t),t}}},function(e,t){!function(e){"use strict";function t(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function n(e){return"string"!=typeof e&&(e=String(e)),e}function r(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return b.iterable&&(t[Symbol.iterator]=function(){return t}),t}function o(e){this.map={},e instanceof o?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function i(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function s(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function a(e){var t=new FileReader,n=s(t);return t.readAsArrayBuffer(e),n}function u(e){var t=new FileReader,n=s(t);return t.readAsText(e),n}function c(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}function l(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function f(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(b.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(b.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(b.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(b.arrayBuffer&&b.blob&&v(e))this._bodyArrayBuffer=l(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!b.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!S(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=l(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):b.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},b.blob&&(this.blob=function(){var e=i(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?i(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(a)}),this.text=function(){var e=i(this);if(e)return e;if(this._bodyBlob)return u(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(c(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},b.formData&&(this.formData=function(){return this.text().then(p)}),this.json=function(){return this.text().then(JSON.parse)},this}function h(e){var t=e.toUpperCase();return A.indexOf(t)>-1?t:e}function d(e,t){t=t||{};var n=t.body;if(e instanceof d){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new o(e.headers)),this.method=e.method,this.mode=e.mode,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new o(t.headers)),this.method=h(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function p(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(o))}}),t}function y(e){var t=new o;return e.split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();t.append(r,o)}}),t}function m(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new o(t.headers),this.url=t.url||"",this._initBody(e)}if(!e.fetch){var b={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(b.arrayBuffer)var g=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],v=function(e){return e&&DataView.prototype.isPrototypeOf(e)},S=ArrayBuffer.isView||function(e){return e&&g.indexOf(Object.prototype.toString.call(e))>-1};o.prototype.append=function(e,r){e=t(e),r=n(r);var o=this.map[e];this.map[e]=o?o+","+r:r},o.prototype.delete=function(e){delete this.map[t(e)]},o.prototype.get=function(e){return e=t(e),this.has(e)?this.map[e]:null},o.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},o.prototype.set=function(e,r){this.map[t(e)]=n(r)},o.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},o.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),r(e)},o.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),r(e)},o.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),r(e)},b.iterable&&(o.prototype[Symbol.iterator]=o.prototype.entries);var A=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];d.prototype.clone=function(){return new d(this,{body:this._bodyInit})},f.call(d.prototype),f.call(m.prototype),m.prototype.clone=function(){return new m(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new o(this.headers),url:this.url})},m.error=function(){var e=new m(null,{status:0,statusText:""});return e.type="error",e};var w=[301,302,303,307,308];m.redirect=function(e,t){if(-1===w.indexOf(t))throw new RangeError("Invalid status code");return new m(null,{status:t,headers:{location:e}})},e.Headers=o,e.Request=d,e.Response=m,e.fetch=function(e,t){return new Promise(function(n,r){var o=new d(e,t),i=new XMLHttpRequest;i.onload=function(){var e={status:i.status,statusText:i.statusText,headers:y(i.getAllResponseHeaders()||"")};e.url="responseURL"in i?i.responseURL:e.headers.get("X-Request-URL");var t="response"in i?i.response:i.responseText;n(new m(t,e))},i.onerror=function(){r(new TypeError("Network request failed"))},i.ontimeout=function(){r(new TypeError("Network request failed"))},i.open(o.method,o.url,!0),"include"===o.credentials&&(i.withCredentials=!0),"responseType"in i&&b.blob&&(i.responseType="blob"),o.headers.forEach(function(e,t){i.setRequestHeader(t,e)}),i.send(void 0===o._bodyInit?null:o._bodyInit)})},e.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},function(e,t,n){!function(t,n){e.exports=n()}("undefined"!=typeof self&&self,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";function r(e){if(!e||"string"!=typeof e)return e;e=e.trim();try{e=JSON.parse(e)}catch(t){e=new Function("return "+e)()}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.cookieS=t.sessionS=t.nameS=t.localS=t.checkStorage=t.isLocalAble=t.isSessionAble=void 0;var o,i,s=n(1),a=n(2),u=function(e){return e&&e.__esModule?e:{default:e}}(a),c=function(e){var t,n="CHECK_STOARGE_TEST";try{return e.setItem(n,1),t=e.getItem(n),e.removeItem(n),1==t}catch(e){return!1}};try{t.isSessionAble=o=c(sessionStorage),t.isLocalAble=i=c(localStorage)}catch(e){t.isSessionAble=o=!1,t.isLocalAble=i=!1}var l={_flush:function(e){e&&(window.name=JSON.stringify(e))},getAll:function(){try{return this.data=r(window.name||"{}")}catch(e){return this.data={}}},setItem:function(e,t){var n=this.data||this.getAll();(0,s.isObject)(n)||(n={}),n[e]=t,this._flush(n)},getItem:function(e){var t=this.data||this.getAll();if((0,s.isObject)(t))return t[e]},removeItem:function(e){var t=this.data||this.getAll();(0,s.isObject)(t)&&(delete t[e],this._flush(t))}},f=function(e,t){e=e||"session",t=t||"STORAGE_NAMESPACE";var n,a,c,f=0;n={local:function(e){return i?[r(localStorage.getItem(e)||"{}"),localStorage]:[r(u.default.getItem(e)||"{}"),u.default]},session:function(e){return o?[r(sessionStorage.getItem(e)||"{}"),sessionStorage]:this.name(e)},name:function(e){return[r(l.getItem(e)||"{}"),l]},storage:function(e){return i?[r(localStorage.getItem(e)||"{}"),localStorage]:this.session(e)},cookie:function(e){return[r(u.default.getItem(e)||"{}"),u.default]}}[e](t),c=n[0],a=n[1];var h=function(e,t){f=40,c[e]={v:t,t:+new Date},b()},d=function(e){var t=c[e],n=t&&t.v;return(0,s.isObject)(n)?Object.assign({},n):(0,s.isArray)(n)?Object.assign([],n):n},p=function(e){f=40,delete c[e],b()},y=function(e){e=e||[];var t,n={};(0,s.isString)(e)&&(e=e.split(",")),e.forEach(function(e){(t=c[e])&&(n[e]=t)}),c=n,b()},m=function(e){return e?Object.assign({},c):c},b=function e(){var n;try{n=JSON.stringify(c)}catch(e){throw console.log("JSON.stringify转化出错",c),new Error(e.message)}try{a.setItem(t,n)}catch(t){if(!(--f>=0))throw new Error("写入存储报错");g(),e()}},g=function(){var e,t,n,r=+new Date;for(var o in c)if(n=c[o],e){if(r-e.t>=864e5)return!1;e.t>n.t&&(e=n,t=o)}else e=n,t=o;e&&delete c[t]};return{clear:y,getAll:m,setItem:h,getItem:d,removeItem:p}},h=f("local"),d=f("cookie"),p=f("name"),y=f("session");t.isSessionAble=o,t.isLocalAble=i,t.checkStorage=c,t.localS=h,t.nameS=p,t.sessionS=y,t.cookieS=d},function(e,t,n){!function(t,n){e.exports=function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";function r(e){return function(t){return Object.prototype.toString.call(t)==="[object "+e+"]"}}Object.defineProperty(t,"__esModule",{value:!0});var o=r("Object"),i=r("String"),s=Array.isArray||r("Array"),a=r("Function"),u=r("Number"),c=r("RegExp"),l=r("Date"),f=r("HTMLBodyElement"),h=r("Boolean");t.isType=r,t.isObject=o,t.isString=i,t.isArray=s,t.isFunction=a,t.isNumber=u,t.isRegExp=c,t.isDate=l,t.isElement=f,t.isBoolean=h}])}()}("undefined"!=typeof self&&self)},function(e,t,n){!function(t,n){e.exports=function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={setItem:function(e,t){var n=arguments[2],r=arguments[3],o=new Date;n?o.setTime(o.getTime()+1e3*n):o.setTime(o.getTime()+36e5),null==r&&(r=document.domain),e=e+"="+(null===t?"; ":encodeURIComponent(t)+"; "),document.cookie=e+"expires="+o.toUTCString()+"; path=/; domain="+r},getItem:function(e){if(0===document.cookie.length)return e?null:{};for(var t,n={},r=document.cookie.split("; "),o=0;o<r.length;o++){if(t=r[o].split("="),e&&t[0]==e)return decodeURIComponent(t[1]);n[t[0]]=decodeURIComponent(t[1])}return e?null:n},getAll:function(){return this.getItem()},removeItem:function(e){this.setItem(e,null,-1,arguments[1])},clear:function(){if(0!==document.cookie.length)for(var e,t=document.cookie.split("; "),n=0;n<t.length;n++)e=t[n].split("="),this.setItem(e[0],null,-1,arguments[0])}}}])}()}("undefined"!=typeof self&&self)}])})}])});